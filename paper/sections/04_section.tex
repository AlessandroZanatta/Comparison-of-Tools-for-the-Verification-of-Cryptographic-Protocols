% Section 4
% 2021-08-19
% Alessandro Zanatta

\section{Tools comparison}
\label{section:features-comparison}
In this section we will compare tools based on their usability, expressiveness, efficiency, soundness and completeness.

\subsection{Usability}
Let us define usability as the easiness of modeling and specifying security properties of a certain protocol.

As Verifpal manual also states \cite{VerifpalManual}, ``Verifpal's main aim is to appeal more to real-world practitioners, students and engineers without sacrificing comprehensive formal verification features''. Its language is extremely simple and fast to learn, queries and equational theory, while restrictive, are usually expressive enough for most cases.

Meanwhile, Proverif and Tamarin both have a steep learning curve as the constructs they are based on can be challenging to grasp at first. Of course, such a statement is hard to prove and has to be partially taken as a personal indication.

\subsection{Expressiveness}
\Cref{tbl:expressiveness} shows expressiveness of analyzed tools.
As we already noticed, all tools assume unbounded sessions. Tamarin's equational theory, with its complex Diffie-Hellman theory (which comprehends 6 equations), is way more expressive then the other two tools (in which only commutativity of exponents is possible).
Proverif support to state is limited to tables, while Verifpal and Tamarin naturally support stateful principals (via different formalisms and syntaxes). Moreover, observational equivalence\footnote{Observational equivalence expresses that two systems appear the same to the environment.} is not supported by Verifpal (which only supports equivalence of terms), but it supports linkability\footnote{Verifpal uses the following definition \cite{VerifpalFoundations}: ``for two
observed values, the adversary cannot distinguish between a protocol execution in
which they belong to the same user and a protocol execution in which they belong to
two different users''.}.

\begin{table}[!ht]
\label{tbl:expressiveness}
\caption{Expressiveness of tools.}
\renewcommand{\arraystretch}{1.5}
\setlength\arrayrulewidth{1pt}
\rowcolors{2}{gray!25}{white}
\makebox[\textwidth][c]{
    \scalebox{0.9}{
        \begin{tabular}{c|ccccc}
        \multicolumn{1}{l|}{} & \textbf{Unbounded} & \textbf{Equational theory} & \textbf{State} & \textbf{Obs. Equiv.} & \textbf{Linkability} \\ \hline
        \textbf{Tamarin}  & \fullcirc & \fullcirc & \fullcirc & \fullcirc  & \emptycirc \\
        \textbf{Proverif} & \fullcirc & \halfcirc & \halfcirc & \fullcirc  & \emptycirc \\
        \textbf{Verifpal} & \fullcirc & \halfcirc & \fullcirc & \emptycirc & \fullcirc
        \end{tabular}
    }
}
\end{table}

\subsection{Efficiency}
\Cref{tab:DH,tab:NSPK} shows three metrics for each tool and protocol version: peak memory usage (in kb), elapsed time since start and cpu time (as system load). 

As it can be seen, Tamarin memory usage is about 5 times the one of Proverif and Verifpal, while time to complete proofs is about two orders of magnitude higher. We can also notice that Proverif is a single-threaded prover\footnote{As cpu time is always $\leq 1$, this means that Proverif is using at most a single core.}, while Tamarin and Verifpal are extensively using all available cores\footnote{The benchmark system has a total of 4 cores.}.

\input{tables/DH}
\input{tables/NSPK}

\subsection{Sound and complete?}

Let us define, in an informal way, what soundness and completeness of formal verification tools means. Please refer to \cite{Furer89oncompleteness} for a more detailed description.

\textbf{Soundness} means that any statement that can be proved is valid (i.e. there is no proof for a false statement).

\textbf{Completeness} means that the proof system is powerful enough to prove any valid statement.

Soundness and completeness of analyzed tools is summarized in \cref{tbl:sound-complete}.

\begin{table}[!ht]
\caption{Soundness and completeness of Tamarin, Proverif and Verifpal.}
\label{tbl:sound-complete}
\centering
\setlength\arrayrulewidth{1pt}
\renewcommand{\arraystretch}{1.4}
\rowcolors{2}{gray!25}{white}
\scalebox{0.9}{
    \begin{tabular}{c|cc}
    \multicolumn{1}{l|}{} & \textbf{Soundness} & \textbf{Completeness}  \\ \hline
    \textbf{Tamarin prover} & \cmark & \cmark \\
    \textbf{Proverif}       & \cmark & \xmark \\
    \textbf{Verifpal}       & \xmark & \xmark
    \end{tabular}
}
\end{table}

\comment{
Tamarin
    Pros:
        - More expressive formulas for security properties
        - Sound and complete
        - Can prove observational equivalence
        - Possibility of manually guiding the proof when heuristics fail to do so automagically
        - Can model many algebraic properties of groups for DH key exchanges (comes with higher computational cost!)
        - Can model xor and elliptic curve operations
        - Supports user defined equational theories
        - More flexibility on post compromise properties using timepoints, but lemmas become more verbose
        - IS SOUND AND COMPLETE
    Cons:
        - Probably harder to model
        - Slower (do benchmarks!!)


Proverif
    Pros:
        - Long history
        - Can prove observational equivalence
        - Supports user defined equational theories
    Cons:
        - Uses an old-style syntax
        - CANNOT model many algebraic properties of groups for DH key exchanges (only commutativity)
        - IS SOUND, BUT NOT COMPLETE


Verifpal
    Pros:
        - Very simple to use (both model specification and queries), while being expressive enough for most use cases (not for 3 parties DH)
        - Possibility to translate to proverif/coq (even though its limited)
        - Very intuitive language
    Cons:
        - There may be queries that CANNOT be expressed (try finding a counterexample!)
        - CANNOT prove observational equivalence
        - It's very recent, still in beta
        - CANNOT model many algebraic properties of groups for DH key exchanges (only commutativity ???)
        - does NOT support user-defined equational theories
        - Does NOT allow to express injectivity
        - Does NOT produce a graphical representation of traces automatically
        - Feels VERY different from other tools
        - Impossible to model 3 parties DH exchange, for example

        - IS NOR SOUND NOR COMPLETE


}